import{X as E,r as o,j as e}from"./app-CI1o2zDc.js";import{M as Y}from"./Head-DCbAlkY9.js";import{H as D,F as T}from"./Footer-CyP-doCv.js";import{a as A}from"./js.cookie-Cz0CWeBA.js";import{d as H}from"./dayjs.min-Bu__Ksdh.js";import"./Helmet-BgtHYfTe.js";function O(){const{get_plan_by_id:t,get_user_info:s}=E().props,[c,f]=o.useState(1),[x,_]=o.useState(!1),[b,y]=o.useState(""),[g,w]=o.useState(""),[d,P]=o.useState("GCASH"),[m,i]=o.useState({}),[h,v]=o.useState(!1),[p,N]=o.useState(60),M=parseInt(t.duration),u=H(),C=u.add(M,"month");o.useEffect(()=>{s.phone&&y(s.phone)},[s.phone]);const k=async n=>{if(n.preventDefault(),!h){v(!0),alert("Verification code has been RESENT.");try{const r=await fetch("/member/plan/form",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({email:s.email,plan_name:t.plan_name,price:t.price,duration:t.duration})});if(!r.ok){const a=await r.json();i({general:a.message||"Error submitting!"})}}catch(r){console.error("Error submitting:",r),i({general:"Something went wrong. Please try again!"})}}},j=async n=>{n.preventDefault();let r={};if(c===1&&!x&&(r.agree="Please accept the terms and conditions before proceeding.",i(r)),c===2&&!g.trim()&&(r.verificationCode="Please enter the verification code sent to your email."),c===3&&d==="GCASH"&&!b.trim()&&(r.gcash="Please enter your GCASH number."),Object.keys(r).length>0){i(r);return}if(i({}),c===1)try{const a=await fetch("/member/plan/form",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({email:s.email,plan_name:t.plan_name,price:t.price,duration:t.duration})});if(!a.ok){const l=await a.json();i({general:l.message||"Error submitting!"});return}}catch(a){console.error("Error submitting:",a),i({general:"Something went wrong. Please try again!"});return}if(c===2&&A.get("membership_verification_code")!=g){r.verificationCode="Wrong verification code, Please check your email!.",i(r);return}if(c===3)if(d=="GCASH")try{const l=await(await fetch("/gcash-payment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({customer_name:s.first_name+" "+s.last_name,phone:s.phone,email:s.email,user_id:s.id,plan_id:t.id,plan_duration:t.duration,plan_price:t.price,plan_name:t.plan_name,plan_description:t.plan_description,payment_method:d,payment_date:u.format("YYYY-MM-DD HH:mm:ss"),start_date:u.format("YYYY-MM-DD HH:mm:ss"),end_date:C.format("YYYY-MM-DD HH:mm:ss"),status:"Approved"})})).json();console.log("Sending Data:",l),l.redirect_url?window.location.href=l.redirect_url:alert("Payment initiation failed. Please try again.")}catch(a){console.error("Payment initiation failed",a),alert("An error occurred while processing your payment. Please try again.")}else try{const a=await fetch("/over-the-counter-payment",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({user_id:s.id,plan_id:t.id,plan_duration:t.duration,plan_price:t.price,plan_name:t.plan_name,plan_description:t.plan_description,payment_method:d,status:"Pending"})});if(a.ok)window.location.href="/member/plan/thank-you";else{const l=await a.json();i({general:l.message||"Error submitting!"});return}}catch(a){console.error("Error submitting:",a),i({general:"Something went wrong. Please try again!"});return}f(a=>Math.min(a+1,3))},S=()=>f(n=>Math.max(n-1,1));return o.useEffect(()=>{let n;return h&&p>0?n=setTimeout(()=>{N(r=>r-1)},1e3):p===0&&(v(!1),N(60)),()=>clearTimeout(n)},[h,p]),e.jsxs(e.Fragment,{children:[c===1&&e.jsx("section",{className:"bmi-calculator-section spad pt-230 step-nav-1",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:"section-title chart-title",children:[e.jsx("span",{children:" Wellfit Fitness Gym - Terms and Conditions"}),e.jsx("h2",{children:"By purchasing a membership, you agree to these terms:"}),e.jsxs("ul",{className:"ul-element",children:[e.jsx("li",{children:"Memberships (1, 3, 6, and 12 months) are non-refundable."}),e.jsx("li",{children:"Access includes gym facilities, showers, WiFi, and expert staff."}),e.jsx("li",{children:"Proper attire and adherence to gym rules are required."}),e.jsx("li",{children:"Wellfit is not liable for injuries or lost items."}),e.jsx("li",{children:"Membership may be terminated for policy violations."}),e.jsx("li",{children:e.jsx("a",{href:"/member/privacy-policy/",target:"_blank",rel:"noopener noreferrer",children:"All personal information is handled in compliance with Republic Act No. 10173 (Data Privacy Act of 2012). "})})]}),e.jsxs("label",{className:"agree-checkbox",children:[e.jsx("input",{type:"checkbox",name:"agree",checked:x,onChange:n=>_(n.target.checked)})," ","  I agree to the terms and conditions stated above."]}),m.agree&&e.jsx("p",{className:"alert alert-danger",children:m.agree}),e.jsx("button",{type:"button",className:"custom-orange-btn mt-3",onClick:j,children:"Continue"})]})}),e.jsx("div",{className:"col-lg-6",children:e.jsx("div",{className:"section-title chart-calculate-title",children:e.jsx("img",{src:"/template/member/img/bg-portraite.webp",alt:"image",className:"bgPortraite1"})})})]})})}),c===2&&e.jsx("section",{className:"bmi-calculator-section spad pt-230 step-nav-2",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-lg-6",children:e.jsxs("div",{className:"section-title chart-title",children:[e.jsx("span",{children:"Email Verification"}),e.jsx("h2",{children:"We sent a verification code to your registered email"}),e.jsx("p",{className:"mb-3 pb-3",children:"For enhanced security, please enter the verification code we sent to your email in the field below. This helps us ensure that your account remains protected and accessible only to you. If you haven’t received the code, please check your spam folder or request a new one."}),e.jsx("input",{type:"text",name:"verification_code",placeholder:"Enter verification code",value:g,className:"col-12",onChange:n=>w(n.target.value)}),m.verificationCode&&e.jsx("p",{className:"alert alert-danger",children:m.verificationCode}),e.jsx("button",{className:"custom-orange-btn mt-3",onClick:j,children:"Continue"}),e.jsx("button",{className:"custom-orange-btn mt-3",onClick:k,disabled:h,children:h?`Resend in ${p}s`:"Resend Verification Code"}),e.jsx("button",{className:"custom-orange-btn mt-3",onClick:S,children:"Back"})]})}),e.jsx("div",{className:"col-lg-6",children:e.jsx("div",{className:"section-title chart-calculate-title",children:e.jsx("img",{src:"/template/member/img/gallery-2.jpg",alt:"image",className:"bgPortraite1"})})})]})})}),c===3&&e.jsx("section",{className:"bmi-calculator-section spad pt-230 step-nav-3",children:e.jsx("div",{className:"container",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-lg-6",children:[e.jsxs("div",{className:"section-title chart-title",children:[e.jsx("span",{children:"Select Payment Method"}),e.jsx("h2",{children:"Please select whether Over-the-Counter or GCash payment"})]}),e.jsx("div",{className:"chart-table",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Membership Type:"}),e.jsx("th",{children:t.plan_name})]})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"point",children:"Price:"}),e.jsxs("td",{children:["₱",parseInt(t.price).toLocaleString()]})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"point",children:"Duration:"}),e.jsx("td",{children:t.duration})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"point",children:"Start Date:"}),e.jsx("td",{children:u.format("MMMM D, YYYY")})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"point",children:"End Date:"}),e.jsx("td",{children:C.format("MMMM D, YYYY")})]})]})]})}),e.jsxs("div",{className:"payment-element-block mt-3 pt-2",children:[e.jsx("span",{className:"orange-label",children:"Select Payment Method:"}),e.jsxs("select",{className:"payment_method",name:"payment_method",value:d,onChange:n=>P(n.target.value),children:[e.jsx("option",{selected:!0,value:"GCASH",children:"GCASH"}),e.jsx("option",{value:"Over The Counter",children:"Over The Counter"})]}),d==="GCASH"&&e.jsx("input",{type:"number",name:"gcash",placeholder:"Enter GCASH Number",value:b,onChange:n=>y(n.target.value)}),m.gcash&&e.jsx("p",{className:"alert alert-danger",children:m.gcash}),e.jsx("button",{className:"custom-orange-btn mt-3",onClick:j,children:"Pay"}),e.jsx("button",{className:"custom-orange-btn mt-3 ",onClick:S,children:"Back"})]})]}),e.jsx("div",{className:"col-lg-6",children:e.jsx("div",{className:"section-title chart-calculate-title",children:e.jsx("img",{src:"/template/member/img/gallery-4.jpg",alt:"image",className:"bgPortraite1"})})})]})})})]})}function I(){return e.jsxs(e.Fragment,{children:[e.jsx(Y,{}),e.jsx(D,{}),e.jsx(O,{}),e.jsx(T,{})]})}export{I as default};
