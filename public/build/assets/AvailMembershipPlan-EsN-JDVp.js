import{X as N,r as o,j as e}from"./app-CI1o2zDc.js";import{A as g,a as S,b as _,c as y}from"./Footer-Du3FwGAi.js";import"./Helmet-BgtHYfTe.js";const A=()=>{const{all_users:m,get_all_plans:r}=N().props,[t,d]=o.useState(""),[l,h]=o.useState(""),p=async()=>{if(t===""||l===""){alert("Please fill the form before submitting.");return}const s=r.find(a=>a.id==l);if(!s){alert("Selected plan not found.");return}const{duration:i,price:u,plan_name:b,plan_description:x}=s,c=new Date,j=c.toISOString().split("T")[0],n=new Date(c);n.setMonth(n.getMonth()+parseInt(i));const f=n.toISOString().split("T")[0];try{const a=await fetch("/over-the-counter-payment",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({user_id:t,plan_id:l,plan_duration:i,plan_price:u,plan_name:b,plan_description:x,start_date:j,end_date:f,payment_method:"Over The Counter",status:"Approved"})});if(a.ok)alert("Membership has been successfully availed."),window.location.href="/admin/membership/list-of-members/";else{const v=await a.json();setErrors({general:v.message||"Error submitting!"});return}}catch(a){console.error("Error submitting:",a),setErrors({general:"Something went wrong. Please try again!"});return}};return e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"Select a member account to join the WellFit Fitness plan."}),e.jsxs("form",{children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label",children:"Select an Account:"}),e.jsx("div",{className:"col-sm-10",children:e.jsxs("select",{className:"form-select","aria-label":"Default select example",name:"user_id",value:t,onChange:s=>d(s.target.value),children:[e.jsx("option",{children:"Select an Account"}),m.map(s=>e.jsxs("option",{value:s.id,children:[s.first_name," ",s.last_name]},s.id))]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label",children:"Select Membership Plan:"}),e.jsx("div",{className:"col-sm-10",children:e.jsxs("select",{className:"form-select","aria-label":"Default select example",name:"plan_id",value:l,onChange:s=>h(s.target.value),children:[e.jsx("option",{children:"Select Membership Plan"}),r.map(s=>e.jsx("option",{value:s.id,children:s.plan_name},s.id))]})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("button",{type:"submit",className:"btn btn-primary",onClick:s=>{s.preventDefault(),p()},children:"Submit"})})]})]})]})})};function E(){return e.jsxs(e.Fragment,{children:[e.jsx(g,{}),e.jsx(S,{}),e.jsx(_,{}),e.jsxs("main",{id:"main",className:"main",children:[e.jsxs("div",{className:"pagetitle",children:[e.jsx("h1",{children:"Avail Membership Plan"}),e.jsx("nav",{children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx("a",{href:"#",children:"Home"})}),e.jsx("li",{className:"breadcrumb-item active",children:"Avail Membership Plan"})]})})]}),e.jsx("section",{className:"section dashboard",children:e.jsx(A,{})})]}),e.jsx(y,{})]})}export{E as default};
