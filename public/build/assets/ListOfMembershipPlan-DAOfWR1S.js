import{X as j,r as n,j as e}from"./app-B5uUBiNZ.js";import{A as x,a as b,b as N,c as f}from"./Footer-DrHeRHwj.js";import"./Helmet-C80axTHt.js";const v=()=>{const{get_all_plans:r,id:y}=j().props,[P,d]=n.useState(null),[c,m]=n.useState(null),[g,S]=n.useState(null),[l,i]=n.useState({planName:"",description:"",price:"",duration:""}),h=async s=>{if(s.preventDefault(),!c){alert("No plan selected to edit.");return}try{const a=await fetch(`/admin/membership/list-of-membership-plan/edit?id=${c}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({plan_name:l.planName,plan_description:l.description,price:l.price,duration:`${l.duration} month${l.duration>1?"s":""}`})}),t=await a.json();console.log(t),a.ok?(alert("Plan updated successfully."),window.location.href="/admin/membership/list-of-membership-plan"):alert("Failed to update plan.")}catch(a){console.error("Update failed:",a)}},p=async s=>{if(window.confirm("Are you sure you want to delete this membership plan?")){d(s);try{const t=await fetch(`/admin/membership/list-of-membership-plan/delete?id=${s}`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]')?.getAttribute("content")},body:JSON.stringify({id:s})}),o=await t.json();t.ok&&(alert("Successfully deleted."),window.location.href="/admin/membership/list-of-membership-plan")}catch(t){console.error("Error submitting:",t)}}},u=s=>{m(s);const a=r.find(t=>t.id===s);if(a){const t=a.duration.match(/\d+/),o=t?parseInt(t[0]):"";i({planName:a.plan_name||"",description:a.plan_description||"",price:a.price||"",duration:o})}};return e.jsxs("div",{children:[e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card recent-sales overflow-auto",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"List Of Membership Plan"}),e.jsxs("table",{className:"table table-borderless datatable",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",children:"Plan Name"}),e.jsx("th",{scope:"col",children:"Duration"}),e.jsx("th",{scope:"col",children:"Price"}),e.jsx("th",{scope:"col",children:"Description"}),e.jsx("th",{scope:"col",children:"Option"})]})}),e.jsx("tbody",{children:r.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.plan_name}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-success",children:s.duration})}),e.jsxs("td",{children:["₱",isNaN(parseInt(s.price))?"N/A":parseInt(s.price).toLocaleString()]}),e.jsx("td",{children:s.plan_description}),e.jsxs("td",{children:[e.jsx("a",{href:"#",onClick:a=>{a.preventDefault(),u(s.id)},children:"Edit"}),"|",e.jsx("a",{href:"#",onClick:a=>{a.preventDefault(),p(s.id)},children:"Delete"})]})]},s.id))})]})]})})}),e.jsx("div",{className:"col-12",children:e.jsx("div",{className:"card recent-sales overflow-auto",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"Edit Plan"}),e.jsxs("form",{onSubmit:h,children:[e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"planName",className:"col-sm-2 col-form-label",children:"Plan Name"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("input",{type:"text",id:"planName",name:"planName",className:"form-control",value:l.planName,onChange:s=>i({...l,planName:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"description",className:"col-sm-2 col-form-label",children:"Description"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("textarea",{id:"description",name:"description",className:"form-control",value:l.description,onChange:s=>i({...l,description:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"price",className:"col-sm-2 col-form-label",children:"Price (₱)"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("input",{type:"number",id:"price",name:"price",className:"form-control",value:l.price,onChange:s=>i({...l,price:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{htmlFor:"duration",className:"col-sm-2 col-form-label",children:"Duration (Months)"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("input",{type:"number",id:"duration",name:"duration",className:"form-control",value:l.duration,onChange:s=>i({...l,duration:s.target.value})})})]}),e.jsxs("div",{className:"row mb-3",children:[e.jsx("label",{className:"col-sm-2 col-form-label"}),e.jsx("div",{className:"col-sm-10",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:"Submit"})})]})]})]})})})]})};function O(){return e.jsxs(e.Fragment,{children:[e.jsx(x,{}),e.jsx(b,{}),e.jsx(N,{}),e.jsxs("main",{id:"main",className:"main",children:[e.jsxs("div",{className:"pagetitle",children:[e.jsx("h1",{children:"List Of Membership Plan"}),e.jsx("nav",{children:e.jsxs("ol",{className:"breadcrumb",children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx("a",{href:"#",children:"Home"})}),e.jsx("li",{className:"breadcrumb-item active",children:"List Of Membership Plan"})]})})]}),e.jsx("section",{className:"section dashboard",children:e.jsx(v,{})})]}),e.jsx(f,{})]})}export{O as default};
